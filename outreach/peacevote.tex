\documentclass{article}
% \title{Open and robust mixnet cascades for electronic voting by identity braiding}

\usepackage{listings}
\title{PeaceVote: absalutelly verifiable, strongly anonymous and robust cryptographic voting system by pseudonym braiding}
\author{Janis Erdmanis}

\date{\today}
% Hint: \title{what ever}, \author{who care} and \date{when ever} could stand 
% before or after the \begin{document} command 
% BUT the \maketitle command MUST come AFTER the \begin{document} command! 


\begin{document}

\maketitle


\begin{abstract}
  Electronic voting problem had been studied extensivelly for decades, however, no technology had achievied the same of trustworthiness as an ordinary paper ballot which is the only robust software independent voting system cabable of preserving participant privacy. A software independent, voting system designs which preserve privacy are possible if shuffling of votes is decentralized, but such system would be extremelly fragile and unpractical. In this paper I propose indentity braiding as a method for eliminating fragility of mixnet cascades for electronic voting applications and discuss a specific implementation of electronic voting for the PeaceVote electronic voting system. 

  % We could imagine decentralizied mixnet cascade where the last step would be to publish all votes with their tags on the buletin board and then make everyone to sign the whoole ballot on the basis if they can find their vote by it's tag. 


  %If everyone would consent we would have a strong basis on claiming that elections had been software independant. 

\end{abstract}

\section{Introduction}

In ordinary paper ballot everyone is able to see that officials are acting accordding to agreed and fair rules as are also able to become the part of them without particular expert knowledge. On the contrary electronic voting schemes suffer from openness and transparency leaving doubt on whether the ellection officials are actually running the software that they claim to do and are not producing fake proofs to support their claims. That made Ron Rivest to claim the term software independance - a software is sad to be software independent if election outcome is independent of undetected modifications to the software which runs the elections [Rivest].

It is rahter easy to design electronic voting system which is software independent but does not preserve privacy. In a simple design each citizen would own state certified public/private key pair which forms a digital identity of the person. To run the ellections the state would publish possible option messages and would collect option certificates (signed documents) from the voters and publish them to for everyone accessable buletin board which everyone could use for verifying and couting the votes. 

Preserving voters anonimity in a software independent system is hard and all known systems make a compromises. There are two issues with combining software independance and privacy. To achieve software independance the data making a conclusive proof for accounting components of the system must be collected and published. This data shall contain votes for everyone with a cryptographical links that it was produced during the ellections by a legitimate voter. At the same time the identity of the voter casting a certain vote shall remain anonymous. We shall call this transparency-anonymity issue.

The second issue comes from execution of the protocol itself. Although the published data preserves anonimity and proves that the system had been software independent we would still face an issue of whether the software of our secure system had not been modified for recording additional information which can be used to reveal the identity of the voter. This we shall denote as security-anonymity issue, as it is possible because the voting machine (or person) has a malicious code on it.

This reasoning allows us to split software independace into two logical components. First one is security with which we shall understand machines (including humans) which execute the election software, collects votes and produces data. With transparency we shall understand all data forming a conclusive proof that the system had been software independent by producing election outcome and applies software indepnedece recursevly to the proof itself. So the trust is a combination of security, transparency and privacy which we can visualize in a Venn diagram as shown figure ....

The main difference between a paper ballot and a mainstream electronic voting solutions is by a number of machines (including humans) adversary needs to hack to compromise the proofs security-transparency (some policing officials in the paper ballot system) and to compromise the anonimity-security (an official collaborating with briber). A private company can be isolated from the society (NDA agreements, individual selection and etc.) and thus it makes it easier to hack. On the other hand hacking software all ellection officials who with their social circles cover all society is impossible without being obvious. This leads us to a idea that a secure ellection system must be open to participation so it could run synchronicaly on multiple machines at once tied to a social circles which can cover all society.

Most of the voting systems on the literature consider a rather peculiar adversary model. When the voting protocol is modeled as a process certain parts of the protocol are trusted for the purpose of verifiability. Although voter could get a assurance from the system a casting assurance (individual verifiability), and able to validate that only eligiable voters had participate, they had voted once and that the votes had been counted accuratelly (universal verifiablity) and making it end to end verifiable he/she still would need to trust the verifying system. 

A similar situation is present for ensuring the anonimity of the vote, when the anonimity preserving system, for example, a mixnet cascade is often assumed to be held private to avoid malicious activities which can result in absence of election results. But if we need to trust the mixes which are private the system nevertheless of the protocol is centralised. Additional data revealing anonimity can be recorded (as long as authentification is part of a private system) and necessary proofs of fair elections can be generated by the organization. Can we avoid thoose issues in the electronic voting system design?

The success of TOR shows that a decentralized anonymous network of mixnet cascades can exist allowing to resit govenment censourship and hiding identity as Eduward Snowden from USA. Other approaches based on mixnets, crowds, onion routing, dc nets are activelly developed and deployed [...]. When evaluating anoniity of such systems one also should take a realistic point of view of adversary who would not be able to control every ISP of the world to deanonymize the traffic. Thus with delocalization and company we can already today use quite strong anonymous sockets.

However anonymous sockets yet does not allow to avoid tracking. Unless the electronic voting is an anonymous pool where voter can vote multiple times the election voting system is going to have authetification. An interesting solution would be to use linkable ring singature scheme, sign the votes with that and deliver to the vote recorder with anonymous socket. Unfortunatelly linkable ring signatures suffer from their length and computational requirements and thus are not practical. Therefore for a practical system we shall focus on anonimization of pseudonyms which can be used for authetification of voting messages.

Anonimization of psudonyms have been studied latelly with the contex of blockchain to make transactions untracable and with context of smart vehicle networks VANET to give valuable information to authorithy while protecting privacy. To my knowledge proposed schemes do suffer from necessity to trust the mixing authorithy and sometimes also necessity to trust other partiipants in the mix. Also anonimity of thoose schemes is of a concern since network anonimization is often disregarded.

In this paper I will propose a new pseudonym anonimization scheme using only public key cryptography which are suitable as substitutes for linkable ring signatures. Then I will show how to use them for electronic voting when simultanously multiple proposals are voted on with PeaceVote system. And lastly I will touch on the issue of testing of the system for small communities, distributing software in a trusted manner while not beeing dependance on usual SSL certificates as well as how memebers can be added easally without making the sytem look complex for the voters. I would also argue that the resulting voting system is strongly sfotware independent due to the fact that anonimization of pseudonyms is done in a small batches and is strongly anonymous because of openness for particiaption. 

\section{Anonimization of psuedoanonymity}

Imagine an ordinary elections. You go to pooling station, greet the gatekeeper who checks your pasport, go to a voting booth but then instead of putting your pick for oficials you put in the envelope your just generated pseudonym, close the envelope un deliver that to ballot box. After the ellections officials publish all pseudonyms in a buletin board (roster). The generated pseudonyms in this fashion would have two great properties namelly they would be anonymous while on the other hand would be legitimate means to be used for signing votes. We shall call such process braiding as it does have a natural hair like structure with knots making hairs indistignuishable and also corresponds terminology used for charectarizing operations on quantum computer forming a superposition of qubits.

Braiding in essence solves the anonimous authetification issue the problem is however how can we substitute paper ballot with electronic one. It may sound like a chicken and egg problem sinece we need to solve electroninc voting to do the psuedonym braiding but it is actually not quite so. One of the great properties of signatures made by psuedonyums is that they are linkable. The linkability allows to do multiple small braids allowing to use multiple small but absoulute consensus ballots as shown in the figure .... Thoose small ballots then can be created by multiple different braiding stations which do not need to be trusted since anonimity is preserved by a lack of coordination. 

To avoid a situation where participants psuedonym gets stolen in a braiding process it is necessary to make individual verifiability as part of the protocol unless other cryptographic proof is provided. That can be achieved if by the end of the ballot it is distributed for every participant to validate and sign thus forming a braid contract. That however introduces fragility in the system since any participant can refuse to follow the protocol and thus terminate the protocol while still remaining anonymous. This limits the number of participants with in the braid.

The fragility of the system can be resolved with two instruments. The first one is that the number of participants in bariding shall be kept small. The second one is using binary search technique to try isolate malicious pseudonyms from the honest ones and do the braiding with different participant sets until the braiding succeeds. Thus no participant can succeed in paralizing the system and the protocol can be cascaded to aquire large anonymity set in a robust fashion.

But who shoud do the braiding? Multiple systems could fit in as voting protocols based on dc nets and p2p networks with which one could do braiding without any authorithy. For mixnets it is necessary to trust the authorithy that no data is being recorded which can be used to reveal the anonimity. If only a single mixnet participates which is maintained by the same organization/person then the anonimity of the vote in the end is equalient to the anonimity which would be provided by a conventional mixnet electronic voting system. 

The fix for that comes from the fact that we no longer need to trust the mix to do its job since in the end participants control with absolute consent whether to accept and sign or discard the braid. That allows to form a system where mixes are distributed over all internet and hosts mixing service irrelelvant of who may use it. That allows to make a braid cascade from multiple mixes and thus resolves any concerns of possible anonimity reveling data as long there are not an inicitaive to coordinate. In the end oordination of mixnet is a threat to anonimity thus any necessity of that should be eliminated.

Openness can be considered as opopisite to coordination. It is important that the voting system should be developed from the effort of the community and as open source world had shown monolithic designs fail to attarct interest. Thus on the one hand it is important from the one hand to make the system such that it is easy to start wheeras on the other it must not loose ability to be customized without breaking off from the exisitng ecosystem. And so in the end every party would find it's place and provide mixer for other people uses.

\section{PeaceVote protocol}

We shall sepperate the dicussion of the proposed voting syustem in a following categories:
\begin{itemize}
  \item setup. 
  \item certification. How to know that you do use a correct software?
  \item registration. How to become a member of the organization?
  \item braiding
  \item proposing and voting
  \item counting and verifying
  \item defence. 
\end{itemize}


As any voting system it needs a maintainer, administrator and protector which we shall name as guardian which can be asingle person or whoole organization. The gurdian in the PeaceVote system is responsable for a following actions:
\begin{itemize}
\item Start the services necessary for the vorting system.
\item Making choices on cryptography used (public key system, hashing, encryption, randomness). 
\item If applicable, selects mixers for braiding. Sets up a number of particicpants for the braid.
\item Approves new memebers for the voting system.
\item Defends the system against DDOS attacks and malicious pseudonyms. 
\end{itemize}
All thoose choices must be transparent and availbale for public scrutinity to change the guardian if no confidence had been expressed. 

Currently, it is conisdered the best practice to issue SSL certificate on the interent service to make it available for a secure access anywhere. That however is unsuitable for a voting system where we need to consider such authorithy to be malicious or even worse selectivelly malicious. Also SSL certificates introduce a complexity for setting up the system for the guardina which I would like to make as seemless as possible.

This is where the DemeNet project comes in. In place of having a trusted authorithy it is better to trust decentralization of the communication channels. 

The guardian is interested that the members of the voting system are real so that anyone should be abel to verify that the whoole community posseses human capacity which can be exercissed as power and that this power is not surpressed by unfounded participants. Currently governments are activelly issuing ID cards with ability to make digital signatures. Unfortunatelly the digital signatures issued by them are only verifiable by a trust service providers which adds complexity for the guardian to verify them.

Ironically the bussiness model of social networks which uses the colllected data to individualize us is also making available data on the internet which can be used to asses the reality of the person and provides the means to establish relativelly secure communication. Currently, it thus seems sensible to use theese releatvelly secure channles to invite a person to the voting system and at the same time to deliver a trust anchor a demespec file.

The demespec file contains only essentials such as the psuedonym of the guardian, cryptographic protocols used, uuid of the self governing community (deme) which thus is a trust anchor. Since demespec file contains little information, it small and also it is not hassle of considering it to be immutable. That allows it to be easally distributed thus a potential memeber could be sure for the genuiness of the invitation from the guardian looking through his trust sources.

\subsection{Setting up the voting system}

To set up the voting system the guardian adds the DemeNet, PeaceVote packages and its dependancies to Julia from a trusted repository. The guardian also addscryptographic primitives for `DemeNet` currently provided only by `PeaceCypher` package.

The first step is to create a trust anchor for the guardian which is contained in `demespec` file and saves that:
\begin{lstlisting}
  using DemeNet
  using PeaceCypher

  demespec = DemeSpec("PeaceDeme",:default,:PeaceCypher,:default,:PeaceCypher,:PeaceVote)
  save(demespec)
\end{lstlisting}
which will create a deme with name `PeaceDeme`, use `PeaceCypher` for cryptographic primitives and say that `PeaceVote` is a peacefounder which for us to simplify discussion currently will not be necessary. Additionally by generating a `demespec` file a private key for the guardian is generated and placed under `.demenet/keys/uuid/maintainer` 

The next step is to set up the server. First a key needs to be generated which we do as follows:
\begin{lstlisting}
  deme = Deme(demespec)
  server = Signer(deme,'server')
\end{lstlisting}
where `deme` is a primitive which additionally with `demespec` also had loaded notary for perfoming digital signatures and cypher for establishing secure comunications with authetificated Diffie-Hellman key exchange.

The next step is to set up the configuration for the braider of the mixnet type. The mixnet braider consists of two parts - it is a gatekeeper and the mixer. The gatekeeper is responsable for authetifications with pseudonyms and is responsable to redirect connectio directly to the mixer where a new psuedonym is sent and latter redelivered back to gatekeeper sorted and forwarded to participants for forming the contract. 

The guardian needs to specify the message length and the number of participants for the braid, as well as authetification details for the mixer. Since the mixer is expected to be from a different deme we define its id with `DemeID` which contains UUID of the deme and thus cryptographic primitives can be loaded from the demespec file stored. The configuration then can be created as:
\begin{lstlisting}
  braiderconfig = BraiderConfig(BRAIDER_PORT,MIXER_PORT,UInt8(3),UInt8(64),SERVER_ID,MIXER_ID)
\end{lstlisting}
where BRAIDER\_PORT and MIXER\_PORT also contains information to establish a socket with server and mixer. PeaceVote only approves integers refering to local ports but with power of multiple dispatch that can be extended with external package with it's own port type. That is particularly useful in a sense that `PeaceVote` does not need to specify whether the server is an oridnary server with ip or hidden service in the TOR. Also it is useful to specify how the ports shall be contacted anonymously, whether it is over a TOR netwok or another way which must be specified by the guardian since anonimity loves company.

The next element needed is configuration of the recorder. The recorder as name states is collecting certified applications, contracted braids, certified proposals and certified votes. The software running it is responsable to prevent redundant information to take part of the ledger. The configuration can be given as follows:
\begin{lstlisting}
  recorderconfig = RecorderConfig([MAINTAINER_ID,SERVER_ID],SERVER_ID,REGISTRATOR_PORT,VOTING_PORT,PROPOSAL_PORT)
\end{lstlisting}
For this service MAINTAINER\_ID, SERVER\_ID are trust anchors who are permited to add new memebers to the deme. The new members are coolected in REGISTRATOR\_PORT who are then able to participate in the braiding. PROPOSAL\_PORT currently is opppen to all members to submit their proposals (in future it will be configurble for example to a board memebers or etc.). VOTING\_PORT is responsable to record all certified votes for a particular proposal. Similarly as BRAIDER\_PORT the VOTING\_PORT contains information on how the anonymous socket can be established.

The last part of the protocol is to decide uppon the mixer service which can be used for other demes and on the synchronization port where collected data from the recorder would be published. The full configuration for the PeaceVote thus can be formed:
\begin{lstlisting}
  braidchainconfig = BraidChainConfig(SERVER_ID,MIXER_PORT,SYNC_PORT,braiderconfig,recorderconfig)
\end{lstlisting}
Currently only a single braider is provided. It is assumed that the guardian periodically changes the braiderconfig thus preventing adversary to (even guardian) collect necessary data from mixers and guardians for revealing the identity of the psuedonym. It's possible to run multiple braiders at the same time but one then would need to deal with shceduling stategies and etc which are not important for the content of this paper of understanding the PeaceVote system.

To start the server the guardian initializes a BraidChain which contains ledger, configuration and deme. BraidChain contains all necessary elements to analyze the data collected by the ledger like to count votes and to participate in the system.
\begin{lstlisting}
  braidchain = BraidChain(braidchainconfig,deme)
\end{lstlisting}
It was coincios choice that the server and the user uses the same configuration data which shows that the system does not have a hidden state. A new guardian can take place of the old one with the data available in the braidchain and configure further evelution of the community at his wish. Though since demespec is immutable he would need to form a new UUID for the deme.

The last step is to start the server:
\begin{lstlisting}
  system = BraidChainServer(braidchain,server)
\end{lstlisting}
which would start all service necessary for the voting system. Since it does not contain any hidden data which one should keep goood care of not corrupting (except the server key) it although complex from the point of number of asynchronous services the system contains it is at the same time pure of sideeffects. That greatly reduces the maintainance costs as in case of problems one can just reinstall the server, put in back the same key (or a new one) and put in the data of the ledger which is stored by every participant everywhere preventing any corruption. 

\subsection{Certification}

The PeaceVote protocol works because user uses the same software as the guardian. But how could users be sure that during the installation of new software a spyware/malware had not been also added?

A true answer to this question from the point of view of the guardian would be to distribute smartcards which shall be used to ensure that keys are safe and that all signatures made had been logged for accountability of additional device which is necessary to interact with the card.

Another way is to trust the software distirbutor and after the fact test whether the system is self with the trusted sources selected by the user. For example, user might receive hashes of the packages certified by guardians and the members of the demes and could compare that with hashes generated locally. That would shrink the area of attack and allow early detection of infected participants since they would certifie packages themselves and distribute the certificates which at any time could be inspected more closelly.

At the moment, however, such certification of software is not implemented since demes are assumed to be small and uncapable to perturb trustworthyness of certified authorithies which allow online and mobile banking to function in practical absence of fraud.

Another part of certification is the configuration of the PeaceVote system. If the guardian would be of curios kind he could make different settings for differrent participants which would allow to reveal identity of the pseudonyms. Thus it is important that all participants would see the same configuration and could confirm that themselves thus it must also be certified by each participant. We will return to this when we will discuss the braiding.

\subsection{Registration}

To take part of the deme the gurdian or it's delegated authorithy needs to sign you pseudonym. From the guardian perspective he is troubled with distinguishing genuine application over boots. In an ideal world the psudonym before sent to the guardian would be signed by a personal smartcard or by a state authorithy confirming your identity though authetification still would reduce us to the need of smartcard or other personal tooken. However ideal wolrd is not always available and if smartcards are available thoose requires developer power and some cheesy subscribtion model which toghether kills accesability.

A solution to such problem could be by using our online presence in different social networks, let it be faceboook, twitter, google, linkedin, openid and etc. which generally do provide enough information for a person to assess whether the person is real or a bot. However it is close to impossible to make a computer program which would do that automatically.

The guardian does have three options. The first one is uppon application the guardian checks the identity online and tries to establish online communication over one of the communication channels to check whether the person applying is not a bot which had borrowed a random identity and onsuch assesment would sign the certificate. The second option is that the guardian uppon a request delivers a tooken to the phone, email or etc. which can be used to register to deme. The last option is to allow everyone in and then kick of thoose which are not real.

The first option is tedius but might be necessary in case high assurance of the identity needs to ensured (investor board meeting). The last option of kicking off unreal memebers are possible by the guardian issuing order that all pseudonym braiding should restart from the their anchors. The second option of delivering a tooken uppon a request is most practical one which is what in one form or another we use on a daily basis and this is the one we shall realy on the daily basis for demenet.

The registration for the DemeNet with a tookens is currently implemented with Recruiters package. The algorithm of it is as follows:
\begin{itemize}
  \item The guardian starts the server certifier service and the tooken reciever service.
  \item A potential memeber is sending application to the guardian or his delegated trusted people.
  \item After a review which could be also automatic if the phone number is provided or other trusted sourcce of communication the applicant receives a tooken, demespec and the information to connect to the registration server. The tooken is sent to the certifier service confidentially.
  \item The applicant generates a key, establishes a secure connection to the guardian certified certifieng service and sends his psuedonym and tooken. 
  \item If tooken is found a certificate is gcreated by the server key and is added to the ledger. Additionally a log file is kept on the communication channels which were used and what information had been used as basis to issue the registartion certificate.
  \end{itemize}
It is important to note that to use Recruiters the guardian is responsable to do the piping of issued certificates of the server to the braidchain. As this and other steps for configuration are so common it is recommended to use PeaceFounder package which integrates PeaceVote with Recruiters.
  
A great thing with tookens is that one can send invitation to people without them making to do work and if they decide to apply they can do that instantly. This is particularly great to form the demes spontaniosly just by starting a server, sending invites to the email, braid and vote. Though users would still need to install an app but if it is activelly used for multiple demes in the long term such cost would be treated as the cost of insatlling a web browser.

\subsection{Braiding}

At his point the memebers have been registered, they have loaded the demespec file sent to them together with invitaion and had synchronized their ledger with the guardian (one way) with the provided infomration in the invitation, for example, a port and ip address. The ledger contains BraidChainConfig certified by the guardian.

The user loads the configuration file and its first step is to gain anonimity by creating a new pseudonyms during the process of braiding. All keys for the psuedonyms are stored locally which as we will see is essential for dynamism in the voting system - braiding shall not limit voting and voting braiding. The storage unit is called KeyChain and can be initialized as follows:
\begin{lstlisting}
  keychain = KeyChain(deme)
\end{lstlisting}
which will load keys from .demenet/keys/uuid/* and sort them in their chonological order.

When the keys are loaded with the braidchain the user can gain anonimity by braiding which can be simply done as:
\begin{lstlisting}
  braid!(braidchain,keychain)
\end{lstlisting}
This simple command in the context of SynchronicBallot is performing a following algorithm:
\begin{itemize}
\item The user authetificates with gatekeeper in both directions with the current pseudonym and encrypts the connection.
\item The gatekeeper forwards the connection to to mixer with which it has authetificated and encrypted.
\item The user using the same socket is now authetificating the mixer and established encrypted connection.
\item The user generates a new key and sends the pseudonym to the mixer
\item The mixer collects all pseudonyms from the participants, sorts them and sends them back to the gatekeeper.
\item The gatekeeper forms a braid from all collected psuedonyms. Additionally the guardian adds hash of the current ledger. (Other relevant metadata can also be added such as time up to which the braid must be published to the ledger and etc.)
\item The participants validate the braid verifying whether their pseudonym is with in the braid and also and also verifying that the hash of the local ledger is the same as hash put in the braid. If validation succeeds the participant signs the braid and delivers the signature to the gatekeeper.
\item If braiding went succesfull, the gatekeeper collects all signatures verifies them and publishes the braid to the braidchain. If unsuccesfull, the procedure is repeated with variations of set of participansts, perhaps of the mixer and etc.
\end{itemize}

In this proceduer the user can be the guardian certified psudonym or any anonymous psuedonym which follows this procedure. If the procedure is repeated it becomes important to anonimize the ip address of the connection which can be done with TOR or others as the guardian wishes to configure that (it can not be up to users deciding how the socket is anonimized because anonimity loves company which leads to a single option).

Additionally during the braiding participants does certify the ledger. This makes the information stored on the ledger immutable to any adversary. Additionally that ensures that all memebers are seeing the same ledger this is convinient as a place where guardian could distribute the configuration of the voting system which prohibits deanonimization attacks by a vicious guardian. Additionally the ledger is a great polace to store other information necessary for certification such as used software hashes or other demespec files and thus forming a true deme network or simply DemeNet.

\subsection{Proposing and Voting}

After braiding each memeber owns a chain of anonimized pseudonyms (KeyChain) which can be used to sign messages in our situation votes. However each psuedonym is itself anonymous and part of the braidchain which one should one use? Is newest one enough? 

Before the vote an elligiable memeber makes a proposal (by default all PeaceVote memebers can make a proposal but not with their pseudonyms). The proposal for the PeaceVote is one of the most abstract it can be for a voting system. In itself it contains two important properties - how the votes for it are going to be counted and what is the input from the user - is it a single question with multiple options or it is a whoole survey a list of questions for which voter is forced to decide on the priorities of the organization in interconnected way having a constraint like in quadratic voting.

The proposal again is registered to a BraidChain to allow everyone who has access to votes count them and to avoid a situation where a proposal gets changed to deliver an opposite outcome. Additionally it defines a set of pseudonyms by the position in the BraidChain which makes a cut to it. This way each anchor pseudonym would have only one vote.

The last step is done by the voter. He synchronizes his braidchain with the guardian and checks it's integrity (see next subsection on validation). Then he filters out the proposals from the BraidChain which are then parsed by user application of the PeaceVote and shown on the screen. To vote user would select a proposal and fill it as specified which he then would sign with keychain:
\begin{lstlisting}
    option = Vote(index,choice)
\end{lstlisting}
The 'index' is the place in the braidchain of the proposal which determines on which proposal one votes on and at the same time defines elligiable set of pseudonyms. The 'choice' is the result of filling out the proposal which has an arbitrary type as proposals can be of many kinds. And the final part is created vote by difitally signing the option by a corresponding pseudonyum in the keychain.
\begin{lstlisting}
    vote = Certificate(option,keychain)
\end{lstlisting}
And finally delivers the vote anonymously by the options specified by the guardian:
\begin{lstlisting}
    record(braidchain,vote)
\end{lstlisting}

\subsection{Validating and Counting}

When the end of voting period had happened it's time to collect votes, validate their elligiablity and count them. The votes themselves can be either published in the braidchain immediately, can be delayed and published later or can be kept in secret which can be useful for implementing antibribery and anticoercion mechanisms (see the next subsection). The second part when all votes had been collected is to validate them, which means that the vote had been signed by a pseudonym created in the process of braiding from root pseudonym and specified by the place of a proposal in the BraidChain. And the last part is to count them as defined by the type of a proposal.

Assuming that all votes had been collected whihc by default in PeaceVote are stored on the BraidChain providing tamper resistance the next step is to validate the BraidChain which can be seperated in a following steps after the ledger had been properly synchronized:
\begin{itemize}
\item Parsing. At this step ledger which is just an array of byte voctors 'Vector{Vector{UInt8}}' is parsed to a `Vector{Union{Certificate,Contract}}` where certificate/contracts contains the doucument and its signatures:
\begin{lstlisting}
    parsedledger = parse(braidchain.ledger)
\end{lstlisting}
\item Validation of immutability. Move through each element in parsedledger and validate that hashes specified in the braid coresponds to hashes of the local ledger:
\begin{lstlisting}
m = validateimutability(parsedledger,deme.notary.hash)
\end{lstlisting}
returns integer m up to which hashes in the braids do agree with hashing of the local ledger.
\item Attestation. At this stage the certificates and contracts are cryptographically verified producing `Vector{Union{Intent,Consensus}}'. Intent and consensus contains the documents and IDs of who issued the signatures. The operation for this procedure can be performed as follows:
\begin{lstlisting}
    verifiedledger = attest(parsedledger,deme.notary)
\end{lstlisting}
\item The last step is to validate the ledger for it's integrity. The result of validation is an index until which the ledger is considered valid. The validation procedure can be described as follows:
  \begin{itemize}
  \item Initialization. Create an empty set for current pseudonyms. And also create a mutable set of parameters - current authorithies who can isssue memeber certificates, a current hash of the ledger. 
  \item Loop. Move through each element in verified ledger
  \item If the element is Intent{Config}. Validate that it comes from the guardian and if so update mutable set of parameters with approved authorithies who can issue a new member certificates. Else break.
  \item If the element is Intent{ID} and is signed by a current authorithies add the pseudonym to the current pseudonyms. Else break.
  \item If the element is Consensus{Braid} and is signed by N current pseudonyms where N is number of new pseudonyms, then swap pseudonyms form the current pseudonym set as specified by the braid. Else break.
  \end{itemize}
\begin{lstlisting}
    n = validateintegrity(verifiedledger,deme.demespec.guardian)
\end{lstlisting}
\end{itemize}
In case the n or m is smaller than the length of the ledger end of the ledger is being cut, the ledger again synchronized with the guardian certified server and the procedure repeated for the end of the ledger.

After the validation of the ledger we can opperate on the data. First we can extract the proposals from the verified ledger which one does as follows:
\begin{lstlisting}
pindexes = proposals(verifiedledger)
\end{lstlisting}
which will return the indicies of the proposals in the ledger. For each proposal index, first we can get the coresponding proposal:
\begin{lstlisting}
proposal = verifiedledger[pid].document
\end{lstlisting}
The votes can be obtained by:
\begin{lstlisting}
votes = getvotes(pid,verifiedledger)
\end{lstlisting}
where each vote is filtered by the braidchain. The proposal may contain end date proposal.date when the voting on the proposal ends which can be incooperated by slicing the verifiedledger.

The final procedure is counting. To do so the user does:
\begin{lstlisting}
tally = count(proposal,votes)
\end{lstlisting}
where one can implement whatever method of counting one wishes. Whether votes can be changed after casted, whether it is a preferential ballot, or multiple question ballot with a constraitn, for example, a budget, queadratic voting. All theese are trivial to implement for the message based voting system.

\section{Adversaries and defence}

I identify three types of attacks adversary could exercise. The first one is attack on the network infrastructure. In this category we have DDOS attacks and attacks on TOR network to reveal the real identity. The second type is infiltrator attack where adversary is part of the system in this case either guardian, mixer, or some coalition of members. And the third kind is an attack on the secrecy of the voter. First it could be malware/spyware on the device or it could be coercer/briber who convinces the voter to colaborate.

\subsection{Attacks on network infrastructure}

Online systems are prone to attacks which can make them offline. Often that is achieved by buying bootnet to make requests on the serveices until they do overload which is definition of DDOS attack. No online ssytem is protected from this kind of attack, however, one can always reason about the costs.

The charetaristics of PeaceVote system allows to distribute load over extended period of time. The braiding procedure which requires stable network and stable operations of gatekeeper and mixer are not required to happen at the ellection day. Thus DDOS attacks on braider become increasingly costly.

The other DDOS attack on election day can happen on the vote recorder. In the current design of PeaceVote the remedy is to use shields which filter out true votes from fake ones. Since all authetification data is in the BraidChain which is available to everyone such shields would be easy to set up if necessary.

Another kind of attack we need to be aware of is the attack on the network anonimizer, for example, TOR netok. It is known that if ISP is all powerfull and records all inputs and outputs the identity can be deanonimized in some given time period. Or there could be infiltrator attacks on the TOR network itself which could make connections with inputs and outputs. The question is how plausable it is?

We can consider Edward Snowden's location as target of USA governement. The information on his ip address could quicly would lead where he is located thus he may just refuse to use it. On the other hand he knows that TOR network makes his IP address untracable which allows him to use interenet and for example participate in discussions in media, conferences and etc where ends of TOR are assigned to his identity. To this point Eduward Snowden had not yet been found proving the strength of anoninimity of the TOR network. 

\subsection{Infiltrator attacks}

The other kind of attacks is when adversory had aquired control over some part of the infrastructure including members. Realisticallly that could hapen due to some security flaw which allows to gain control of the servers or the people themselves had become corrupt due to some circumstances. In any case it is necessary that the adversory can be detected, isolated and its attack defended. We shal consider three kinds of adversories and their colobaraions. The vicios guardian, mixer and coalition of a subset of members.

The isolated guardian as adversory can block accesability of services and filter out which votes he would like to accept with the recorder and also accept fake identities. In the case when the guardian blocks accesability it could turn out to be tricky to detect whether it is due to him being corrupt or due to receiveing a DDOS attack, however for the later if shield or even multple ones are used the attack could be defended by a wise guardian. Thus its impeachment due to DDOS attack should not be symphatized with.

The guardian is also responsable on acceptance on new memebers. A legit question for a participant would be whether thoose are actually real. This question can be tested statistically. To do so a random set of participants are selected and thoose identities then are mached with the guardian published contact details which should lead to some social network network or etc. The last step is then to contact thoose people to see whether they know that they are part of the deme.

The other malicios action which guardian could do is to accept for recording only thoose votes which are of his liking. To detect such situation trustworthy the vote can be delivered first to a policing authorithy with TOR which then tries to publish it to the recorder. If it fails it sends the vote to the next policing authorithy which again tries to publish that. In this way consensus of corrupt guardian would be created and thus could be impeached.

The guardian is also responsable in ensuring that mixer and memebers are not breaking down the service. In the case of mixer the most malicious thing would be to alter the ballots by inserting his own pseudonym or just slightly corrupting it. In such action the braid would come to participants where one would find it corrupt and thus refuse to sign i breaking the protocol. At this point the guardian does have a hard time to deciding on who to blame.

At this point the guardian has two things he can try. First one he can try to repeat the braiding procedure by excluding thoose who refused to sign the ballot until the braiding protocol succeeds. And later one letting thoose who terminate the protocol braid with themselves. If that fails a significant number of participants had entered the braiding prison the guardian might suspect that the mixer is corrupt which he can let publically known. The solution here is just to issue a new configuration which uses a new mixer which a trustworthy guardian should do regualrly anyways which we will now consider.

The next type of advisory is one who controls the mixer and the gatekeeper. Such sitution easally rises when in the PeaceVote protocol mixer is self hosted by the same guardian. In such situation advisory can silently record aditional data which allows to reveal identities with coresponding pseudonyms. To prevent rise of such situation the participants may require that the mixer is changed regularly and that the mixer is served by other trustworthy guardian on the internet.

\subsection{Secrecy attacks}

The last type of advisory is one who attacks the secrecy of the voter. In paper ballot system only the voter knows the secret on how he voted on and thus the briber/coercer is powerless on whether the voter is telling the truth unless he uses a lie detector or something. In electronic voting there are no way to ensure that the voter is voting on the device without adversary behind his back observing. Additionally the advisory could be operating anonymously behind the internet or the device the voter uses could have malware/spyware. 

To avoid malware/spyware a certification procedure is used. The goal is to avoid mlaware/spyware to come form the PeaceVote protocol which is open to extension with different cryptographic methods, network anonimizers and etc. As described in certification section the PeaceVote protocol could perform self-consitency checks with already trusted sources before using a new component. Initial trust source as package repository would be provided by the distributor of PeaceVote.

The next type of malware/spyware could come from the device itself. First it could come from an another application on the device. To avoid such situations Vendors are already putting applications in containers which do have restricted access. In the end thus it is Vendoors responsability that device does not have a malware on it. That currently, for example, allows mobile banking to happen without major issues of fraud. Thus why not make the same trustworthyness assumption on electronic voting?

The first an most dangerous attack on secrecy is by anonymous briber/coercer. The briber can exchange certian amount of money for an exchange of vote. Additionally for the PeaceVote protocol the briber could ask for the psudonym key itself which they could use for unlimited voting while still having a backing from a real identity.

To fight selling of pseudonyms online we need to prevent it's extraction from device. It could be made possible that the keys are stored and generted during braidng in the smartcard itself thus preventing its users to sell their pseudonyms. The identity pseudonym then could be signed by a Vendoor issued key on the card itself to prove that issued key and derived ones in the process of braiding are not possible to be extracted. The card itself then can be verified with biometrics (with which I mean one signs video chat with the key on the card or etc.) that it does belong to a real person.

Not able to buy pseudonyms the briber/coercer would turn to buy votes instead. In the case of anonymous advisory the strategy would be that the vote would be collected by it before delivered to the recorder in that way ensuring that an existing vote is not smuggled into him. Additionaly he may only give payment after the ellections had ended and the bought vote had been accuratelly voted on.

To solve such issue most voting systems implement some form of receipt freeness or as I like to simplify prooflessness. In the PeaceVote system prooflessness can be implemented if the votes are not published but only the tally at the end of the vote. Then one can implement ability to silently change the vote after it had already been sold to briber/coercer. But in doing so one sacrifices transperancy, particularly, universal verifiabliity of the voters for prooflesseness. The votes though themselves can be universally verified by the permitted personel.

Perhaps a more succesfull extension to the PeaceVote system would be if the voter would have ability to choose whether the vote is going to be public or hidden. By default the voter would publish the vote for everyone to see, but in the case there are opportunity to sell it to the briber he/she does so. But after the fact submits a new vote which remains hidden from everyone except from the guardian (or his derivative) who after elections issues correction to the public result as a tally.

As long as the election result, who happens to be ellected and who not, is determined from the publically available ones there would be no point to look question the integrity of the guardian who counts the hidden votes. Furthermore to prevent maliciosness of the guardian independent audtitor could be used to recount the correction.

Similarly the same bribery/coercion mechanism could work in person as long as the briber is not looking behind the back of the voter and then collect the device after the vote until the end of ellections. To prevent such scenario the voters should have ability to defend themselves, for example, by issuing a tagged vote in the presence of briber/coercer which would give a signal to authorities that a possible crime is happensing and try to catch briber/coercer while the crime is happening. 

\section{Discussion}

Electronic voting is a very complex problem which can have a great consequences on the democracy. Each system comes with its own need of expert knowledge and thus discussion of the most trustworthy design publically could potentially be steered to insecure systems to the benefit of capital. It is thus important to battle test voting systems and start small. As the power of democracy built with them becomes larger they stand a chance to gain interest for hacking by coorporations and capital who are interested that there would not be such thing as a society.

The PeaceVote voting system while complex is the first system which achieves a true transparency, security and privacy. The trust on it is derived from thoose components and not from a trusted personel. The system in strongly software independent for voting. The ssytem does not contain hidden state and can be reset/restarted at any time with the publically available data. The guardians are powerless. Their wise actions and reputation is what matters for a new guardian to show up and impeach the old one. The design allows to have a largest mixnet cascade which is possible due to oppenness and introduced process called braiding. The system scales in two directions. Though one may wish to fragment it to some regions and etc. to limit the processing power and storage needed for participants.

Although complex it is one of the easiest to set up. In contrast to blockchain ideology, it is fine to start small. The trust is bulit from wise actions and not from competions of wasted work (PoW) and/or legitimatized inequality (PoS). A new guardian can start with a single raspberry pi and use automatic configuration which would generte a key for the deme and for the server which does not requitre a permanent ip address or SSL certificate to be trustoworthy. Then to use it voters only need to install application on their smartphones which would allow to participate in different demes. 

The PeaceVote voting system also allows easally to be used for whistleblowing where in place of issuing votes one can just sign a leaked document with a psuedonym. This could be particulalry useful for coorperations which accorindng to most democratic european laws require that whistleblowing should be possible and even encouraged to prevent ill effects on society. Ensuring a strong anonimity of whistleblowers is what PeaceVote can do. 

The infrsastrucure around PeaceVote is more generic than the voting itself. Particularly DemeNet addresses issue of requiring SSL certificate isued by authorithy which is substituted with self consistency and directly distributing the ids of the guardians. That allows easally add other ser services like chatting, messaging service. A localized search engine. A news distributor where the voting could allow for subscribers to decide uppon what content they would like to see and thus giving innitiative to pay subscriptions.

The interent had become dystopia, full of tracking and suspicion of sincerity of information. It's time to come togehter and start to found some peace with the world around us. Its time to voice of expressing trust and breaking systematic media surpression of public opinion.

\begin{thebibliography}{9}
  
\bibitem{Adida2016} Ben Adida. 2006. Advances in cryptographic voting systems. Ph.D. Dissertation. Massachusetts Institute of Technology, USA. Advisor(s) Ronald L. Rivest.
\bibitem{Anderson1995} Anderson R., Needham R. (1995) Programming Satan's computer. In: van Leeuwen J. (eds) Computer Science Today. Lecture Notes in Computer Science, vol 1000. Springer, Berlin, Heidelberg
\bibitem{Chaum1981} Chaum, D. L. (1981). Untraceable electronic mail, return addresses, and digital pseudonyms. Communications of the ACM, 24(2), 84-90.
\bibitem{CoinShuffle2014} Ruffing, T., Moreno-Sanchez, P., \& Kate, A. (2014, September). Coinshuffle: Practical decentralized coin mixing for bitcoin. In European Symposium on Research in Computer Security (pp. 345-364). Springer, Cham.
\bibitem{Danezis2003} Serjantov, Andrei \& Danezis, George. (2003). Towards an Information Theoretic Metric for Anonymity. 2482. 10.1007/3-540-36467-6\_4.
\bibitem{Danezis2008} Danezis, G., \& Diaz, C. (2008). A survey of anonymous communication channels (Vol. 27, p. 30). Technical Report MSR-TR-2008-35, Microsoft Research.
\bibitem{DolevYao1983} Dolev, D., \& Yao, A. (1983). On the security of public key protocols. IEEE Transactions on information theory, 29(2), 198-208.
\bibitem{Franck2008} Christian Franck (2008). New Directions for Dining Cryptographers. MSc thesis.
\bibitem{GolleJuels2004} Golle, P., \& Juels, A. (2004, May). Dining cryptographers revisited. In International Conference on the Theory and Applications of Cryptographic Techniques (pp. 456-473). Springer, Berlin, Heidelberg.
\bibitem{Gritzalis2002} Dimitris Gritzalis (2002) Secure Electronic Voting
\bibitem{PublicEvidence2017} Bernhard M. et al. (2017) Public Evidence from Secret Ballots. In: Krimmer R., Volkamer M., Braun Binder N., Kersting N., Pereira O., Schrmann C. (eds) Electronic Voting. E-Vote-ID 2017. Lecture Notes in Computer Science, vol 10615. Springer, Cham 
\bibitem{Rivest2008} Rivest, R. L. (2008). On the notion of software independencein voting systems. Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences, 366(1881), 3759-3767.
\bibitem{Sampigethaya2006} Sampigethaya, K., \& Poovendran, R. (2006). A survey on mix networks and their secure applications. Proceedings of the IEEE, 94(12), 2142-2181.
\bibitem{USVote2015} Dzieduszycka-Suinat, S., Ph., I.M., Kiniry, J., Zimmerman, D.M., Wagner, D., Robinson, P., \& Adam (2015). The Future of Voting End-to-end Verifiable Internet Voting Specification and Feasibility Assessment Study Internet Voting Today No Guarantees End-to-end Verifiability E2e-viv.

  
  
\end{thebibliography}

\end{document}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
